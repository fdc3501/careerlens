# 개발문서 (MVP)

---

## 0. 문서 메타

- **문서 목적**: 아이디어 → MVP 개발
- **작성일**: 2026-02-16
- **작성자**: CareerLens 팀
- **버전**: v4.2 (Complete Engineering + Full Template Compliance)
- **상태**: 최종 확정본

---

## 1. 제품 개요 (Overview)

`CareerLens` 서비스는 사용자가 자신의 커리어 정보를 직접 입력하거나 이력서(PDF, DOCX)를 업로드하면 이를 구조화하여 분석하고, 무료 공개 API에서 수집한 정량 데이터를 기반으로 구조화된 신호(Decision Signals)를 생성한 뒤, 명확한 임계값 기준 충족 여부에 따라 현재 시장 위치와 향후 Career Development Guide를 포함한 구조적 리포트를 제공하는 서비스다.

본 서비스의 리포트는 외부 정보를 AI가 직접 검색하여 답변하는 방식이 아니라, 사전에 정의된 구조화된 신호(Decision Signals)를 기반으로 생성된다.

---

## 2. 서비스명 설계

- 모바일/웹 어디서 봐도 즉시 이해 가능
- 서비스명: CareerLens

---

## 3. 문제정의

사용자는 특정 결정을 내려야 하는 상황에서 여러 정보를 찾아보지만, 판단에 사용할 명확한 기준이 없어 스스로 결론을 내리기 어렵다.  
ChatGPT와 같은 AI에 질문하면 그럴듯한 설명은 얻을 수 있지만, 어떤 데이터와 기준을 근거로 한 판단인지가 명확하지 않아 그 결과를 신뢰하거나 확신하기 어렵다.  
그 결과 사용자는 '결정은 해야 하지만, 그 결정을 책임질 수 있는 근거는 없는 상태’에 놓이게 되며, 이 불확실성과 불안이 핵심적인 문제로 작용한다.

본 서비스는 위 문제를 커리어 의사결정 영역에 적용한다.

---

## 4. 타깃 사용자 (ICP – 상태 기반)

- **상태**: “지금 판단이 필요한 사람”
- **행동**:
  - 검색을 여러 번 해봤다
  - 엑셀로 정리하려다 포기했다
  - 무료 툴을 써봤지만 확신이 없다

---

## 5. 플랫폼 전략 (Web + Mobile)

- Mobile-first 웹 설계 (Responsive)
- iOS / Android 확장 (PWA → Native)
- React + TypeScript 기반
- Video 환경 대응 (React Video)
- Cloudflare Pages + Functions 사용
- 이력서 업로드 기능 지원 (PDF, DOCX)

### 모바일 UX 원칙

- 한 화면 = 한 질문
- 스크롤 최소화
- 입력 피로 최소화
- 진행률 표시 항상 표시

---

## 6. 언어 선택

- 한국어 / 영어 선택 가능
- 기본값: 한국어

---

## 7. UX 원칙

- 사용자는 입력 과정에서 ‘생각하거나 해석하지 않아도’ 다음 단계로 자연스럽게 진행할 수 있어야 한다.
- 모든 결과 화면은 결론을 먼저 제시하고, 근거와 설명은 그 아래에 배치한다.
- 확률, 예측, 가능성 표현은 사용하지 않으며, 명확한 기준과 임계값 충족 여부만을 제공한다.
- AI는 결정을 내리지 않고, 구조화된 신호를 기반으로 한 해석과 설명만을 수행한다.
- 데이터의 한계나 누락, 시스템 제약은 숨기지 않고 사용자에게 명확한 문구로 안내한다.
- 결제 전 단계에서는 무료 API만 사용하며, 유료 API는 절대 호출하지 않는다.

### 7.1. 실패 및 환불 UX 원칙

- API 오류, 결제 오류, 리포트 생성 실패 등 서비스 핵심 기능이 정상적으로 제공되지 않은 경우, 사용자의 요청 여부와 관계없이 환불을 기본 원칙으로 한다.
- 사용자는 문제를 증명하거나 별도의 환불 요청 절차를 거치지 않아도 된다.
- 시스템 장애로 판단되는 모든 케이스는 “서비스 실패”로 간주하며, 사업자는 책임을 사용자에게 전가하지 않는다.
- 환불 처리 여부는 AI 판단이 아닌 시스템 상태 플래그 기준으로 자동 결정한다.
- 서비스 핵심 결과물이 정상적으로 제공되지 않은 경우, 사용자는 비용 부담 없이 자동 환불을 받아야 한다.

---

## 8. 사용자 흐름 (UX Flow) 정의

### Step 1
- 랜딩페이지 → Get Started

### Step 2
- 사용자 여정 선택 화면
  - 직접 입력
  - 이력서 업로드

### Step 3
- API 사용은 무료
- 간단한 형태의 출력물 제공

무료 미리보기는 다음 무료 API 데이터만 사용하여 생성한다.
- GitHub API
- StackExchange API
- Google Trends API (캐싱 필수)
- RSS Feed
- NPM API
- PyPI API

### Step 4
- 결제
  - 금액 미확정 (큰 사용량은 내부 비용 관측용이며, 사용자 결제 금액은 별도 가격 정책에 따라 결정)
  - 테스트 단계: 로컬 / Sandbox
  - 실제 결제: Polar
  - 모바일 결제: Apple Pay / Google Pay

#### Step 4-1 결제 실패 시
- 결제 완료 후 아래 항목 중 하나라도 실패 시 결제는 자동 취소 또는 즉시 환불 처리하며, 사용자에게는 실패 사유 + 환불 완료 안내 제공
  - API 데이터 수집 실패
  - 리포트 생성 실패
  - 리포트 출력/저장 실패

### Step 5
- 전체 리포트 제공
  - AI 생성 Single-shot
  - 모바일 카드 UI 최적화
  - 그래프 및 데이터 표 포함
  - 이미지 저장, 공유, 메일 전송 가능

---

## 9. 입력 설계

- 사용자 여정 기반 입력 설계

### 이력서 파싱 기술 설계

1. 파일 수신
   - PDF, DOCX
   - 5MB 제한
   - MIME 검증

2. 텍스트 추출
   - PDF → pdf-parse
   - DOCX → mammoth
   - OCR 미지원

3. 섹션 분리
   - Experience / Education / Skills / Projects 키워드 기반 정규식

4. 기술 스택 추출
   - 사전 정의 Skill Dictionary(JSON)
   - 소문자 정규화
   - Levenshtein distance ≤ 1 허용

5. 경력 연차 계산
   - 날짜 패턴 추출 (YYYY.MM)
   - 시작~종료 계산
   - 6개월 이상 공백 제외

6. 직무 분류
   - 기술 스택 룰 기반 매핑

---

## 10. 핵심 판단 지표 (Decision Signals)

- 여러 API(무료)로 수치 가져옴

### 사용 API (모두 무료 API)

- GitHub API
- StackExchange API
- Google Trends API (캐싱 필수)
- RSS Feed
- NPM API
- PyPI API

모든 데이터는 무료 API만 사용하며, 최소 데이터만 수집하여 비용 0을 유지한다.

---

## 11. API 소스

- 무료 API + 최소 데이터만 사용 → 비용 0 유지

### API 실패 대응 전략

- 사용자는 "실패했다"는 느낌을 받지 않아야 함
- 항상 부분 결과라도 제공
- 신뢰를 떨어뜨리지 않는 문구 사용
- API 실패로 인해 ‘유료 리포트 품질 기준’을 충족하지 못하는 경우, 해당 세션은 유료 처리하지 않는다.
- 이미 결제가 완료된 경우, 해당 트랜잭션은 자동 환불 대상이 된다.

---

## 12. 결정 로직

- AI는 설명 + 서사화만 수행

임계값:
- 70 이상 → Strong
- 40~69 → Stable
- 39 이하 → Weak

---

## 13. 리포트 생성 — OpenAI API

- 본 서비스의 리포트는
  외부 정보를 AI가 직접 검색하여 답변하는 방식이 아니라,
  사전에 정의된 구조화된 신호(Decision Signals)를 기반으로 생성된다.

- AI는 판단을 내리지 않으며,
  수집된 신호와 기준을 바탕으로
  결과를 설명하고 서사화하는 역할만 수행한다.

- 리포트는 단일 요청(Single-shot) 방식으로 생성되며,
  생성 완료 여부는 시스템 플래그로 관리한다.

- 비교 기준:
  - ChatGPT: 질문 기반, 비구조적 응답
  - 본 서비스: 신호 기반, 구조적 판단 리포트

---

## 14. 리포트 프롬프트 설계

- System / User Prompt 템플릿 추가
- 구조화된 JSON 입력 기반
- Career Development Guide 섹션 강제 포함

---

## 15. 수치 노출 원칙

- 확률 ❌ → 임계값 ✅ → 책임 회피 구조 명확

### 수치 표현 규칙

- 소숫점 1자리하되 3자리 이상의 수치라면 소숫점은 생략
- 단위 명시
- 비교 기준 명시

---

## 16. 분석을 위한 자료수집 원칙

- 사실 기반 관측하여 신뢰성 확보

---

## 17. 리포트 구조

- 결제 전 요약은 무료여야 한다
- 이미지/공유/메일 가능해야 한다
- 결제 후 전체 리포트 제공해야 한다
- 전체 리포트는 AI로 물어볼 때의 답과는 차별점이 있어야 한다

### Career Development Guide 알고리즘

1. Skill Gap = 시장 평균 점수 − 사용자 점수
2. Gap ≥ 20 → 개선 필요
3. Gap ≥ 40 → 전략적 전환 고려
4. Trend ≥ 70 AND Gap ≥ 20 → 3개월 학습 권고
5. Demand ≤ 40 → 대체 기술 추천
6. 0~3개월 / 3~6개월 / 6~12개월 로드맵 생성

---

## 18. 분석 및 태그

- Google Analytics 태그 적용
- Microsoft Clarity 적용

---

## 19. SEO 최적화

- Google Search Central 가이드에 따라 기술적·콘텐츠 SEO를 적용
- 검색엔진 친화적인 URL, 메타 태그, 구조화된 데이터 적용
- 반응형 웹 + 모바일 UX 최적화로 검색 노출 극대화
- 검색 의도(Search Intent)에 맞는 콘텐츠 구조 설계

### 검색 의도 기반 콘텐츠 설계
- 정보 탐색형 / 거래형 / 탐색형 검색 의도 구분
- 각 여정에 맞는 랜딩 페이지 및 리포트 구조 설계

### 구조화된 데이터 적용
- JSON-LD 형식으로 리포트, FAQ, HowTo 등 마크업
- 검색 결과에서 리치 스니펫 노출 유도

### 성능 최적화
- Core Web Vitals 기준 충족
- 이미지 최적화, 코드 분할, 캐싱 전략 적용

---

## 20. GEO 최적화

- 생성형 AI(LLM)가 인용하기 쉬운 구조화된 콘텐츠 설계
- 질문 중심 콘텐츠 구조 (Q&A, Executive Summary + 심층 분석)
- E-E-A-T 요소 강화:
  - 명확한 저자 정보
  - 실제 사례 및 정량적 데이터
  - 신뢰할 수 있는 출처 명시
- AI가 요약하기 쉬운 형식:
  - 비교표, 체크리스트, 인포그래픽 설명
  - 단일 주제에 대한 다양한 형식 콘텐츠 (가이드, 사례, FAQ)
- AI가 학습하기 쉬운 문장 구조:
  - 명확한 주어 + 동사 + 목적어
  - 불필요한 수사적 표현 배제

---

## 21. 토큰 사용량 모니터링 (운영 목적)

- 본 서비스는 개발, 테스트, 실제 운영 과정에서
  리포트 생성에 사용된 OpenAI API 토큰 사용량을 지속적으로 기록한다.

- 토큰 사용량 모니터링의 목적은
  실시간 사용자 과금이나 결제 로직이 아니라,
  서비스의 평균 비용 구조를 파악하기 위함이다.

- 수집되는 주요 지표는 다음과 같다.
  - 리포트 1건당 평균 토큰 사용량
  - 입력 토큰(input tokens)과 출력 토큰(output tokens)의 비율
  - Decision Signals 수에 따른 토큰 사용량 변화
  - 개발 환경과 운영 환경 간 토큰 사용량 차이

- 해당 데이터는 내부 운영 지표로만 활용되며,
  사용자에게 직접 노출되지 않는다.

- 토큰 사용량 데이터는
  향후 가격 정책 및 상품 구조를 설계하기 위한
  참고 자료로만 사용한다.

---

## 22. 정책 / 규제 준수

- Terms of Service 포함
- Refund Policy 포함

### Refund Policy

본 서비스는 결과 기반 디지털 서비스로, 서비스 핵심 결과물이 정상적으로 제공되지 않은 경우 전액 환불을 기본 원칙으로 합니다.

다음 상황에서는 자동 환불이 진행됩니다.

1) API 장애로 인해 리포트 생성이 불가능한 경우  
2) 결제는 완료되었으나 리포트 출력이 실패한 경우  
3) 시스템 오류로 인해 결과 접근이 불가능한 경우  

환불은 사용자의 별도 요청 없이 자동 처리되며, 환불 완료 시 이메일 또는 화면 안내를 통해 고지합니다.  
단, 사용자가 정상적으로 전체 리포트를 확인한 이후에는 환불 대상에 해당하지 않습니다.

- Privacy Policy 포함
- 글로벌 규제 준수 (GDPR, CCPA 등)
- Polar 결제 관련 규정 준수

---

## 23. 결제 테스트 및 배포

- 테스트: 로컬 / Sandbox
- 실제 결제: Polar 결제
- 모바일 결제: Apple Pay / Google Pay
- Github + Cloudflare 연동 → Push 시 자동 배포

### Polar 결제 구현 요약

- 목표: PRODUCT_ID를 기반으로 Polar 결제를 생성하고, 결제 완료 시 report_generated = true로 상태를 업데이트한다.
- 입력값:
  - PRODUCT_ID (예: polar_1234567890)
  - mode (sandbox 또는 live)
- 출력값:
  - 결제 요청 생성 (Polar API 호출)
  - 결제 완료 시 Webhook 수신 및 상태 업데이트
- 흐름:
  - /api/checkout에서 결제 요청 생성
  - Polar에서 결제 완료 시 Webhook 전송
  - Webhook 수신 → report_generated = true
  - report_generated === false 상태에서 종료 시 자동 환불
- 제약조건:
  - 로컬에서는 절대 Live API 호출 금지
  - Webhook 서명 검증 필수
  - 환경별 API 키 분리 (POLAR_SANDBOX_TOKEN, POLAR_LIVE_TOKEN)

---

## 24. 백엔드 / 보안

- Cloudflare Pages Functions 활용 → 중요 API Key 보관
- 로컬 개발용 키 폴더 (/local_env/keys) 생성, .gitignore 처리 → 깃허브 푸시 제외
- Polar 결제 테스트 시 Cloudflare Functions 환경변수로 키 사용
- 환경별(로컬 / sandbox / production) 설정 분리

### [결제 트랜잭션 상태 관리 원칙]

- 모든 결제 트랜잭션에는 리포트 생성 성공 여부를 나타내는 상태 플래그(`report_generated`)를 포함한다.
- 해당 플래그가 `true`로 확정되기 전까지, 해당 결제 건은 매출로 확정 처리하지 않는다.
- 리포트 생성 실패, API 오류, 출력 실패 등으로 `report_generated`가 `false` 상태로 종료될 경우, 해당 트랜잭션은 자동 환불 대상이 된다.
- 환불 판단 로직은 AI 또는 운영자 판단이 아닌, 시스템 상태 플래그를 기준으로 자동 처리한다.
- AI 구현 가이드
  - 위 원칙을 기반으로 /api/checkout과 /api/webhooks/polar 함수를 구현하세요.
  - PRODUCT_ID는 환경변수 또는 요청 파라미터로 전달받아 사용하세요.
  - report_generated는 DB 또는 스토리지에 저장하고, Webhook 수신 시 업데이트하세요.
